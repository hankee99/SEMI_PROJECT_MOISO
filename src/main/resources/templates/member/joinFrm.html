<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>회원가입</title>
</head>
<body>
	<th:block th:include="common/header"></th:block>
	<main class="content">
			<section class="section join-wrap">
				<div class="page-title">회원가입</div>
				<form action="/member/join" method="post" autocomplete="off">
					<div class="input-wrap">
						<div class="input-title">
							<label for="memberId">아이디</label>
							<p>로그인시 활용할 아이디를 입력해주세요.</p>
							</div>
						<div class="input-item">
							<input type="text" name="memberId" id="memberId">
						</div>
						<p class="input-msg id-check-msg"></p>
					</div>
					<div class="input-wrap">
						<div class="input-title">
							<label for="memberPw">비밀번호</label>
						</div>
						<div class="input-item">
							<input type="password" name="memberPw" id="memberPw">
						</div>
					</div>
					<div class="input-wrap">
						<div class="input-title">
							<label for="memberPwRe">비밀번호 확인</label>
						</div>
						<div class="input-item">
							<input type="password" name="memberPwRe" id="memberPwRe">
						</div>
						<p class="input-msg pw-check-msg"></p>
					</div>
					<div class="input-wrap">
						<div class="input-title">
							<label for="memberName">이름</label>
							<p>로그인시 활용할 아이디를 입력해주세요.</p>
						</div>
						<div class="input-item">
							<input type="text" name="memberName" id="memberName">
						</div>
					</div>
					<div class="input-wrap">
						<div class="input-title">
							<label for="memberPhone">전화번호</label>
						</div>
						<div class="input-item">
							<input type="text" name="memberPhone" id="memberPhone">
						</div>
					</div>

					<div class="join-button-box">
						<button type="submit" class="btn-primary lg join-btn" value="회원가입">회원가입</button>
					</div>
					
				
				</form>
			</section>
		
		</main>
		<script>
		
		
		  $("#memberId").on("keyup", function(){
			$(".id-check-msg").removeClass("invalid").removeClass("valid");
			//정규표현식(영어 대/소문자/숫자로 4~20글자)
			const idReg = /^[a-zA-Z0-9]{4,20}$/;
			const memberId = $("#memberId").val();
			if(idReg.test(memberId)){
				//정규표현식에 만족하면 중복체크
			
				$.ajax({
					url : "/member/ajaxCheckId",
					type : "get",
					data : {memberId : memberId},
					success : function(result){
						if(result){
							$(".id-check-msg").text("사용 가능한 아이디입니다.");
							$(".id-check-msg").addClass("valid");
						}else{
							$(".id-check-msg").text("이미 사용 중인 아이디입니다.");
							$(".id-check-msg").addClass("invalid");
						}
					},
					error : function(){
						console.log("실패");
					}
				});
			}else{
				//정규표현식에 만족하지 못하면 메세지 출력
				$(".id-check-msg").text("아이디는 영어 대/소문자, 숫자로 4~20글자입니다.");
				$(".id-check-msg").addClass("invalid");
			}	
		});
		$("#memberPwRe").on("keyup", function(){
			$(".pw-check-msg").removeClass("valid").removeClass("invalid");
			const pw = $("#memberPw").val();
			const pwRe = $("#memberPwRe").val();
			if(pw === pwRe){
				$(".pw-check-msg").text("비밀번호가 일치합니다.");
				$(".pw-check-msg").addClass("valid");
			}else{
				$(".pw-check-msg").text("비밀번호가 일치하지 않습니다.");
				$(".pw-check-msg").addClass("invalid");
			}			
		});
		
		$(".join-btn").on("click",function(e){
			const valid = $(".valid");
			if(valid.length !== 2){
				alert("입력값을 확인하세요.");
				e.preventDefault();//기본이벤트제거(submit이벤트 제거)
			}
		});
		  
		</script>
		
	<th:block th:include="common/footer"></th:block>
</body>
</html>